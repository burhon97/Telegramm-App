"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cls = void 0;
const cls_hooked_1 = require("cls-hooked");
const _namespace = cls_hooked_1.createNamespace('@kibertoad/als');
exports.cls = {
    storageImplementation: 'cls-hooked',
    get: (key) => {
        if (_namespace.active) {
            return _namespace.get(key);
        }
        return undefined;
    },
    set: (key, value) => {
        if (_namespace.active) {
            _namespace.set(key, value);
        }
    },
    runWith: (callback, defaults) => {
        _namespace.run(() => {
            if (defaults) {
                const objectKeys = Object.keys(defaults);
                for (let i = 0; i < objectKeys.length; i++) {
                    _namespace.set(objectKeys[i], defaults[objectKeys[i]]);
                }
            }
            callback();
        });
    },
};
exports.default = exports.cls;
//# sourceMappingURL=cls-fallback.js.map